{% extends 'core/base.html' %}

{% block title %}Assign Collector - Admin{% endblock %}

{% block content %}
<div style="max-width: 800px; margin: 0 auto;">
    <div style="margin-bottom: 2rem;">
        <h1>Assign Collector</h1>
        <p style="color: #718096;">Select a collector for this product pickup</p>
    </div>

    <div class="card" style="margin-bottom: 2rem; background: #f7fafc;">
        <h3>üì¶ Product Details</h3>
        <div style="margin-top: 1rem;">
            <p><strong>Category:</strong> {{ product.category|default:"Uncategorized" }}</p>
            <p><strong>Customer:</strong> {{ product.customer.get_full_name }} ({{ product.customer.email }})</p>
            <p><strong>Address:</strong> {{ product.address }}</p>
            <p><strong>Current Status:</strong> {{ product.get_status_display }}</p>
        </div>
    </div>

    <div class="card">
        <h3>üöö Available Collectors</h3>
        
        {% if collectors %}
        <form method="post" style="margin-top: 1.5rem;">
            {% csrf_token %}
            
            <div class="form-group">
                <label><strong>Select Collector:</strong></label>
                <div style="margin-top: 1rem; display: flex; flex-direction: column; gap: 1rem;">
                    {% for collector in collectors %}
                    <label style="display: flex; align-items: center; padding: 1rem; border: 2px solid #e2e8f0; border-radius: 8px; cursor: pointer; transition: all 0.2s;">
                        <input type="radio" name="collector_id" value="{{ collector.id }}" required style="margin-right: 1rem;">
                        <div style="flex: 1;">
                            <strong>{{ collector.user.get_full_name }}</strong>
                            <span style="background: #667eea; color: white; padding: 0.2rem 0.5rem; border-radius: 15px; font-size: 0.8rem; margin-left: 0.5rem;">
                                {{ collector.vehicle_display }}
                            </span>
                            <br>
                            <small style="color: #718096;">
                                Current Pickups: {{ collector.current_pickups }}/3 | 
                                Rating: {{ collector.rating }} ‚≠ê | 
                                Total Deliveries: {{ collector.total_deliveries }}
                            </small>
                        </div>
                    </label>
                    {% endfor %}
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button type="submit" class="btn" style="background: #667eea; padding: 12px 30px;">Assign Collector</button>
                <a href="{% url 'admin_product_list' %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
        {% else %}
        <div style="text-align: center; padding: 2rem; background: #fed7d7; border-radius: 8px; margin-top: 1rem;">
            <p style="color: #742a2a; font-weight: bold;">‚ö†Ô∏è No collectors available</p>
            <p style="color: #742a2a;">All verified collectors are at maximum capacity (3 pickups) or unavailable.</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}